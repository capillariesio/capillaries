{
    "nodes": {
        "1_read_accounts": {
            "type": "file_table",
            "desc": "Load accounts from parquet",
            "r": {
                "urls": [
                    "{dir_in}/accounts.parquet"
                ],
                "columns": {
                    "col_account_id": {
                        "parquet": {
                            "col_name": "account_id"
                        },
                        "col_type": "string"
                    },
                    "col_earliest_period_start": {
                        "parquet": {
                            "col_name": "earliest_period_start"
                        },
                        "col_type": "datetime"
                    }
                }
            },
            "w": {
                "name": "accounts",
                "table_options": "",
                "having": "!time.After(w.earliest_period_start, time.Parse(`2006-01-02`,`{period_start_eod}`))",
                "fields": {
                    "account_id": {
                        "expression": "r.col_account_id",
                        "type": "string"
                    },
                    "earliest_period_start": {
                        "expression": "r.col_earliest_period_start",
                        "type": "datetime"
                    }
                }
            }
        },
        "1_read_txns": {
            "type": "file_table",
            "desc": "Load txns from parquet",
            "r": {
                "urls": [
                    "{dir_in}/txns_000.parquet",
                    "{dir_in}/txns_001.parquet",
                    "{dir_in}/txns_002.parquet",
                    "{dir_in}/txns_003.parquet",
                    "{dir_in}/txns_004.parquet",
                    "{dir_in}/txns_005.parquet",
                    "{dir_in}/txns_006.parquet",
                    "{dir_in}/txns_007.parquet",
                    "{dir_in}/txns_008.parquet",
                    "{dir_in}/txns_009.parquet",
                    "{dir_in}/txns_010.parquet",
                    "{dir_in}/txns_011.parquet",
                    "{dir_in}/txns_012.parquet",
                    "{dir_in}/txns_013.parquet",
                    "{dir_in}/txns_014.parquet",
                    "{dir_in}/txns_015.parquet",
                    "{dir_in}/txns_016.parquet",
                    "{dir_in}/txns_017.parquet",
                    "{dir_in}/txns_018.parquet",
                    "{dir_in}/txns_019.parquet",
                    "{dir_in}/txns_020.parquet",
                    "{dir_in}/txns_021.parquet",
                    "{dir_in}/txns_022.parquet",
                    "{dir_in}/txns_023.parquet",
                    "{dir_in}/txns_024.parquet",
                    "{dir_in}/txns_025.parquet",
                    "{dir_in}/txns_026.parquet",
                    "{dir_in}/txns_027.parquet",
                    "{dir_in}/txns_028.parquet",
                    "{dir_in}/txns_029.parquet",
                    "{dir_in}/txns_030.parquet",
                    "{dir_in}/txns_031.parquet",
                    "{dir_in}/txns_032.parquet",
                    "{dir_in}/txns_033.parquet",
                    "{dir_in}/txns_034.parquet",
                    "{dir_in}/txns_035.parquet",
                    "{dir_in}/txns_036.parquet",
                    "{dir_in}/txns_037.parquet",
                    "{dir_in}/txns_038.parquet",
                    "{dir_in}/txns_039.parquet",
                    "{dir_in}/txns_040.parquet",
                    "{dir_in}/txns_041.parquet",
                    "{dir_in}/txns_042.parquet",
                    "{dir_in}/txns_043.parquet",
                    "{dir_in}/txns_044.parquet",
                    "{dir_in}/txns_045.parquet",
                    "{dir_in}/txns_046.parquet",
                    "{dir_in}/txns_047.parquet",
                    "{dir_in}/txns_048.parquet",
                    "{dir_in}/txns_049.parquet",
                    "{dir_in}/txns_050.parquet",
                    "{dir_in}/txns_051.parquet",
                    "{dir_in}/txns_052.parquet",
                    "{dir_in}/txns_053.parquet",
                    "{dir_in}/txns_054.parquet",
                    "{dir_in}/txns_055.parquet",
                    "{dir_in}/txns_056.parquet",
                    "{dir_in}/txns_057.parquet",
                    "{dir_in}/txns_058.parquet",
                    "{dir_in}/txns_059.parquet",
                    "{dir_in}/txns_060.parquet",
                    "{dir_in}/txns_061.parquet",
                    "{dir_in}/txns_062.parquet",
                    "{dir_in}/txns_063.parquet",
                    "{dir_in}/txns_064.parquet",
                    "{dir_in}/txns_065.parquet",
                    "{dir_in}/txns_066.parquet",
                    "{dir_in}/txns_067.parquet",
                    "{dir_in}/txns_068.parquet",
                    "{dir_in}/txns_069.parquet",
                    "{dir_in}/txns_070.parquet",
                    "{dir_in}/txns_071.parquet",
                    "{dir_in}/txns_072.parquet",
                    "{dir_in}/txns_073.parquet",
                    "{dir_in}/txns_074.parquet",
                    "{dir_in}/txns_075.parquet",
                    "{dir_in}/txns_076.parquet",
                    "{dir_in}/txns_077.parquet",
                    "{dir_in}/txns_078.parquet",
                    "{dir_in}/txns_079.parquet",
                    "{dir_in}/txns_080.parquet",
                    "{dir_in}/txns_081.parquet",
                    "{dir_in}/txns_082.parquet",
                    "{dir_in}/txns_083.parquet",
                    "{dir_in}/txns_084.parquet",
                    "{dir_in}/txns_085.parquet",
                    "{dir_in}/txns_086.parquet",
                    "{dir_in}/txns_087.parquet",
                    "{dir_in}/txns_088.parquet",
                    "{dir_in}/txns_089.parquet",
                    "{dir_in}/txns_090.parquet",
                    "{dir_in}/txns_091.parquet",
                    "{dir_in}/txns_092.parquet",
                    "{dir_in}/txns_093.parquet",
                    "{dir_in}/txns_094.parquet",
                    "{dir_in}/txns_095.parquet",
                    "{dir_in}/txns_096.parquet",
                    "{dir_in}/txns_097.parquet",
                    "{dir_in}/txns_098.parquet",
                    "{dir_in}/txns_099.parquet",
                    "{dir_in}/txns_100.parquet",
                    "{dir_in}/txns_101.parquet",
                    "{dir_in}/txns_102.parquet",
                    "{dir_in}/txns_103.parquet",
                    "{dir_in}/txns_104.parquet",
                    "{dir_in}/txns_105.parquet",
                    "{dir_in}/txns_106.parquet",
                    "{dir_in}/txns_107.parquet",
                    "{dir_in}/txns_108.parquet",
                    "{dir_in}/txns_109.parquet",
                    "{dir_in}/txns_110.parquet",
                    "{dir_in}/txns_111.parquet",
                    "{dir_in}/txns_112.parquet",
                    "{dir_in}/txns_113.parquet",
                    "{dir_in}/txns_114.parquet",
                    "{dir_in}/txns_115.parquet",
                    "{dir_in}/txns_116.parquet",
                    "{dir_in}/txns_117.parquet",
                    "{dir_in}/txns_118.parquet",
                    "{dir_in}/txns_119.parquet",
                    "{dir_in}/txns_120.parquet",
                    "{dir_in}/txns_121.parquet",
                    "{dir_in}/txns_122.parquet",
                    "{dir_in}/txns_123.parquet",
                    "{dir_in}/txns_124.parquet",
                    "{dir_in}/txns_125.parquet",
                    "{dir_in}/txns_126.parquet",
                    "{dir_in}/txns_127.parquet",
                    "{dir_in}/txns_128.parquet",
                    "{dir_in}/txns_129.parquet",
                    "{dir_in}/txns_130.parquet",
                    "{dir_in}/txns_131.parquet",
                    "{dir_in}/txns_132.parquet",
                    "{dir_in}/txns_133.parquet",
                    "{dir_in}/txns_134.parquet",
                    "{dir_in}/txns_135.parquet",
                    "{dir_in}/txns_136.parquet",
                    "{dir_in}/txns_137.parquet",
                    "{dir_in}/txns_138.parquet",
                    "{dir_in}/txns_139.parquet",
                    "{dir_in}/txns_140.parquet",
                    "{dir_in}/txns_141.parquet",
                    "{dir_in}/txns_142.parquet",
                    "{dir_in}/txns_143.parquet",
                    "{dir_in}/txns_144.parquet",
                    "{dir_in}/txns_145.parquet",
                    "{dir_in}/txns_146.parquet",
                    "{dir_in}/txns_147.parquet",
                    "{dir_in}/txns_148.parquet",
                    "{dir_in}/txns_149.parquet",
                    "{dir_in}/txns_150.parquet",
                    "{dir_in}/txns_151.parquet",
                    "{dir_in}/txns_152.parquet",
                    "{dir_in}/txns_153.parquet",
                    "{dir_in}/txns_154.parquet",
                    "{dir_in}/txns_155.parquet",
                    "{dir_in}/txns_156.parquet",
                    "{dir_in}/txns_157.parquet",
                    "{dir_in}/txns_158.parquet",
                    "{dir_in}/txns_159.parquet",
                    "{dir_in}/txns_160.parquet",
                    "{dir_in}/txns_161.parquet",
                    "{dir_in}/txns_162.parquet",
                    "{dir_in}/txns_163.parquet",
                    "{dir_in}/txns_164.parquet",
                    "{dir_in}/txns_165.parquet",
                    "{dir_in}/txns_166.parquet",
                    "{dir_in}/txns_167.parquet",
                    "{dir_in}/txns_168.parquet",
                    "{dir_in}/txns_169.parquet",
                    "{dir_in}/txns_170.parquet",
                    "{dir_in}/txns_171.parquet",
                    "{dir_in}/txns_172.parquet",
                    "{dir_in}/txns_173.parquet",
                    "{dir_in}/txns_174.parquet",
                    "{dir_in}/txns_175.parquet",
                    "{dir_in}/txns_176.parquet",
                    "{dir_in}/txns_177.parquet",
                    "{dir_in}/txns_178.parquet",
                    "{dir_in}/txns_179.parquet",
                    "{dir_in}/txns_180.parquet",
                    "{dir_in}/txns_181.parquet",
                    "{dir_in}/txns_182.parquet",
                    "{dir_in}/txns_183.parquet",
                    "{dir_in}/txns_184.parquet",
                    "{dir_in}/txns_185.parquet",
                    "{dir_in}/txns_186.parquet",
                    "{dir_in}/txns_187.parquet",
                    "{dir_in}/txns_188.parquet",
                    "{dir_in}/txns_189.parquet",
                    "{dir_in}/txns_190.parquet",
                    "{dir_in}/txns_191.parquet",
                    "{dir_in}/txns_192.parquet",
                    "{dir_in}/txns_193.parquet",
                    "{dir_in}/txns_194.parquet",
                    "{dir_in}/txns_195.parquet",
                    "{dir_in}/txns_196.parquet",
                    "{dir_in}/txns_197.parquet",
                    "{dir_in}/txns_198.parquet",
                    "{dir_in}/txns_199.parquet",
                    "{dir_in}/txns_200.parquet",
                    "{dir_in}/txns_201.parquet",
                    "{dir_in}/txns_202.parquet",
                    "{dir_in}/txns_203.parquet",
                    "{dir_in}/txns_204.parquet",
                    "{dir_in}/txns_205.parquet",
                    "{dir_in}/txns_206.parquet",
                    "{dir_in}/txns_207.parquet",
                    "{dir_in}/txns_208.parquet",
                    "{dir_in}/txns_209.parquet",
                    "{dir_in}/txns_210.parquet",
                    "{dir_in}/txns_211.parquet",
                    "{dir_in}/txns_212.parquet",
                    "{dir_in}/txns_213.parquet",
                    "{dir_in}/txns_214.parquet",
                    "{dir_in}/txns_215.parquet",
                    "{dir_in}/txns_216.parquet",
                    "{dir_in}/txns_217.parquet",
                    "{dir_in}/txns_218.parquet",
                    "{dir_in}/txns_219.parquet",
                    "{dir_in}/txns_220.parquet",
                    "{dir_in}/txns_221.parquet",
                    "{dir_in}/txns_222.parquet",
                    "{dir_in}/txns_223.parquet",
                    "{dir_in}/txns_224.parquet",
                    "{dir_in}/txns_225.parquet",
                    "{dir_in}/txns_226.parquet",
                    "{dir_in}/txns_227.parquet",
                    "{dir_in}/txns_228.parquet",
                    "{dir_in}/txns_229.parquet",
                    "{dir_in}/txns_230.parquet",
                    "{dir_in}/txns_231.parquet",
                    "{dir_in}/txns_232.parquet",
                    "{dir_in}/txns_233.parquet",
                    "{dir_in}/txns_234.parquet",
                    "{dir_in}/txns_235.parquet",
                    "{dir_in}/txns_236.parquet",
                    "{dir_in}/txns_237.parquet",
                    "{dir_in}/txns_238.parquet",
                    "{dir_in}/txns_239.parquet",
                    "{dir_in}/txns_240.parquet",
                    "{dir_in}/txns_241.parquet",
                    "{dir_in}/txns_242.parquet",
                    "{dir_in}/txns_243.parquet",
                    "{dir_in}/txns_244.parquet",
                    "{dir_in}/txns_245.parquet",
                    "{dir_in}/txns_246.parquet",
                    "{dir_in}/txns_247.parquet",
                    "{dir_in}/txns_248.parquet",
                    "{dir_in}/txns_249.parquet",
                    "{dir_in}/txns_250.parquet",
                    "{dir_in}/txns_251.parquet",
                    "{dir_in}/txns_252.parquet",
                    "{dir_in}/txns_253.parquet",
                    "{dir_in}/txns_254.parquet",
                    "{dir_in}/txns_255.parquet",
                    "{dir_in}/txns_256.parquet",
                    "{dir_in}/txns_257.parquet",
                    "{dir_in}/txns_258.parquet",
                    "{dir_in}/txns_259.parquet",
                    "{dir_in}/txns_260.parquet",
                    "{dir_in}/txns_261.parquet",
                    "{dir_in}/txns_262.parquet",
                    "{dir_in}/txns_263.parquet",
                    "{dir_in}/txns_264.parquet",
                    "{dir_in}/txns_265.parquet",
                    "{dir_in}/txns_266.parquet",
                    "{dir_in}/txns_267.parquet",
                    "{dir_in}/txns_268.parquet",
                    "{dir_in}/txns_269.parquet",
                    "{dir_in}/txns_270.parquet",
                    "{dir_in}/txns_271.parquet",
                    "{dir_in}/txns_272.parquet",
                    "{dir_in}/txns_273.parquet",
                    "{dir_in}/txns_274.parquet",
                    "{dir_in}/txns_275.parquet",
                    "{dir_in}/txns_276.parquet",
                    "{dir_in}/txns_277.parquet",
                    "{dir_in}/txns_278.parquet",
                    "{dir_in}/txns_279.parquet",
                    "{dir_in}/txns_280.parquet",
                    "{dir_in}/txns_281.parquet",
                    "{dir_in}/txns_282.parquet",
                    "{dir_in}/txns_283.parquet",
                    "{dir_in}/txns_284.parquet",
                    "{dir_in}/txns_285.parquet",
                    "{dir_in}/txns_286.parquet",
                    "{dir_in}/txns_287.parquet",
                    "{dir_in}/txns_288.parquet",
                    "{dir_in}/txns_289.parquet",
                    "{dir_in}/txns_290.parquet",
                    "{dir_in}/txns_291.parquet",
                    "{dir_in}/txns_292.parquet",
                    "{dir_in}/txns_293.parquet",
                    "{dir_in}/txns_294.parquet",
                    "{dir_in}/txns_295.parquet",
                    "{dir_in}/txns_296.parquet",
                    "{dir_in}/txns_297.parquet",
                    "{dir_in}/txns_298.parquet",
                    "{dir_in}/txns_299.parquet",
                    "{dir_in}/txns_300.parquet",
                    "{dir_in}/txns_301.parquet",
                    "{dir_in}/txns_302.parquet",
                    "{dir_in}/txns_303.parquet",
                    "{dir_in}/txns_304.parquet",
                    "{dir_in}/txns_305.parquet",
                    "{dir_in}/txns_306.parquet",
                    "{dir_in}/txns_307.parquet",
                    "{dir_in}/txns_308.parquet",
                    "{dir_in}/txns_309.parquet",
                    "{dir_in}/txns_310.parquet",
                    "{dir_in}/txns_311.parquet",
                    "{dir_in}/txns_312.parquet",
                    "{dir_in}/txns_313.parquet",
                    "{dir_in}/txns_314.parquet",
                    "{dir_in}/txns_315.parquet",
                    "{dir_in}/txns_316.parquet",
                    "{dir_in}/txns_317.parquet",
                    "{dir_in}/txns_318.parquet",
                    "{dir_in}/txns_319.parquet",
                    "{dir_in}/txns_320.parquet",
                    "{dir_in}/txns_321.parquet",
                    "{dir_in}/txns_322.parquet",
                    "{dir_in}/txns_323.parquet",
                    "{dir_in}/txns_324.parquet",
                    "{dir_in}/txns_325.parquet",
                    "{dir_in}/txns_326.parquet",
                    "{dir_in}/txns_327.parquet",
                    "{dir_in}/txns_328.parquet",
                    "{dir_in}/txns_329.parquet",
                    "{dir_in}/txns_330.parquet",
                    "{dir_in}/txns_331.parquet",
                    "{dir_in}/txns_332.parquet",
                    "{dir_in}/txns_333.parquet",
                    "{dir_in}/txns_334.parquet",
                    "{dir_in}/txns_335.parquet",
                    "{dir_in}/txns_336.parquet",
                    "{dir_in}/txns_337.parquet",
                    "{dir_in}/txns_338.parquet",
                    "{dir_in}/txns_339.parquet",
                    "{dir_in}/txns_340.parquet",
                    "{dir_in}/txns_341.parquet",
                    "{dir_in}/txns_342.parquet",
                    "{dir_in}/txns_343.parquet",
                    "{dir_in}/txns_344.parquet",
                    "{dir_in}/txns_345.parquet",
                    "{dir_in}/txns_346.parquet",
                    "{dir_in}/txns_347.parquet",
                    "{dir_in}/txns_348.parquet",
                    "{dir_in}/txns_349.parquet",
                    "{dir_in}/txns_350.parquet",
                    "{dir_in}/txns_351.parquet",
                    "{dir_in}/txns_352.parquet",
                    "{dir_in}/txns_353.parquet",
                    "{dir_in}/txns_354.parquet",
                    "{dir_in}/txns_355.parquet",
                    "{dir_in}/txns_356.parquet",
                    "{dir_in}/txns_357.parquet",
                    "{dir_in}/txns_358.parquet",
                    "{dir_in}/txns_359.parquet",
                    "{dir_in}/txns_360.parquet",
                    "{dir_in}/txns_361.parquet",
                    "{dir_in}/txns_362.parquet",
                    "{dir_in}/txns_363.parquet",
                    "{dir_in}/txns_364.parquet",
                    "{dir_in}/txns_365.parquet",
                    "{dir_in}/txns_366.parquet",
                    "{dir_in}/txns_367.parquet",
                    "{dir_in}/txns_368.parquet",
                    "{dir_in}/txns_369.parquet",
                    "{dir_in}/txns_370.parquet",
                    "{dir_in}/txns_371.parquet",
                    "{dir_in}/txns_372.parquet",
                    "{dir_in}/txns_373.parquet",
                    "{dir_in}/txns_374.parquet",
                    "{dir_in}/txns_375.parquet",
                    "{dir_in}/txns_376.parquet",
                    "{dir_in}/txns_377.parquet",
                    "{dir_in}/txns_378.parquet",
                    "{dir_in}/txns_379.parquet",
                    "{dir_in}/txns_380.parquet",
                    "{dir_in}/txns_381.parquet",
                    "{dir_in}/txns_382.parquet",
                    "{dir_in}/txns_383.parquet",
                    "{dir_in}/txns_384.parquet",
                    "{dir_in}/txns_385.parquet",
                    "{dir_in}/txns_386.parquet",
                    "{dir_in}/txns_387.parquet",
                    "{dir_in}/txns_388.parquet",
                    "{dir_in}/txns_389.parquet",
                    "{dir_in}/txns_390.parquet",
                    "{dir_in}/txns_391.parquet",
                    "{dir_in}/txns_392.parquet",
                    "{dir_in}/txns_393.parquet",
                    "{dir_in}/txns_394.parquet",
                    "{dir_in}/txns_395.parquet",
                    "{dir_in}/txns_396.parquet",
                    "{dir_in}/txns_397.parquet",
                    "{dir_in}/txns_398.parquet",
                    "{dir_in}/txns_399.parquet",
                    "{dir_in}/txns_400.parquet",
                    "{dir_in}/txns_401.parquet",
                    "{dir_in}/txns_402.parquet",
                    "{dir_in}/txns_403.parquet",
                    "{dir_in}/txns_404.parquet",
                    "{dir_in}/txns_405.parquet",
                    "{dir_in}/txns_406.parquet",
                    "{dir_in}/txns_407.parquet",
                    "{dir_in}/txns_408.parquet",
                    "{dir_in}/txns_409.parquet",
                    "{dir_in}/txns_410.parquet",
                    "{dir_in}/txns_411.parquet",
                    "{dir_in}/txns_412.parquet",
                    "{dir_in}/txns_413.parquet",
                    "{dir_in}/txns_414.parquet",
                    "{dir_in}/txns_415.parquet",
                    "{dir_in}/txns_416.parquet",
                    "{dir_in}/txns_417.parquet",
                    "{dir_in}/txns_418.parquet",
                    "{dir_in}/txns_419.parquet",
                    "{dir_in}/txns_420.parquet",
                    "{dir_in}/txns_421.parquet",
                    "{dir_in}/txns_422.parquet",
                    "{dir_in}/txns_423.parquet",
                    "{dir_in}/txns_424.parquet",
                    "{dir_in}/txns_425.parquet",
                    "{dir_in}/txns_426.parquet",
                    "{dir_in}/txns_427.parquet",
                    "{dir_in}/txns_428.parquet",
                    "{dir_in}/txns_429.parquet",
                    "{dir_in}/txns_430.parquet",
                    "{dir_in}/txns_431.parquet",
                    "{dir_in}/txns_432.parquet",
                    "{dir_in}/txns_433.parquet",
                    "{dir_in}/txns_434.parquet",
                    "{dir_in}/txns_435.parquet",
                    "{dir_in}/txns_436.parquet",
                    "{dir_in}/txns_437.parquet",
                    "{dir_in}/txns_438.parquet",
                    "{dir_in}/txns_439.parquet",
                    "{dir_in}/txns_440.parquet",
                    "{dir_in}/txns_441.parquet",
                    "{dir_in}/txns_442.parquet",
                    "{dir_in}/txns_443.parquet",
                    "{dir_in}/txns_444.parquet",
                    "{dir_in}/txns_445.parquet",
                    "{dir_in}/txns_446.parquet",
                    "{dir_in}/txns_447.parquet",
                    "{dir_in}/txns_448.parquet",
                    "{dir_in}/txns_449.parquet",
                    "{dir_in}/txns_450.parquet",
                    "{dir_in}/txns_451.parquet",
                    "{dir_in}/txns_452.parquet",
                    "{dir_in}/txns_453.parquet",
                    "{dir_in}/txns_454.parquet",
                    "{dir_in}/txns_455.parquet",
                    "{dir_in}/txns_456.parquet",
                    "{dir_in}/txns_457.parquet",
                    "{dir_in}/txns_458.parquet",
                    "{dir_in}/txns_459.parquet",
                    "{dir_in}/txns_460.parquet",
                    "{dir_in}/txns_461.parquet",
                    "{dir_in}/txns_462.parquet",
                    "{dir_in}/txns_463.parquet",
                    "{dir_in}/txns_464.parquet",
                    "{dir_in}/txns_465.parquet",
                    "{dir_in}/txns_466.parquet",
                    "{dir_in}/txns_467.parquet",
                    "{dir_in}/txns_468.parquet",
                    "{dir_in}/txns_469.parquet",
                    "{dir_in}/txns_470.parquet",
                    "{dir_in}/txns_471.parquet",
                    "{dir_in}/txns_472.parquet",
                    "{dir_in}/txns_473.parquet",
                    "{dir_in}/txns_474.parquet",
                    "{dir_in}/txns_475.parquet",
                    "{dir_in}/txns_476.parquet",
                    "{dir_in}/txns_477.parquet",
                    "{dir_in}/txns_478.parquet",
                    "{dir_in}/txns_479.parquet",
                    "{dir_in}/txns_480.parquet",
                    "{dir_in}/txns_481.parquet",
                    "{dir_in}/txns_482.parquet",
                    "{dir_in}/txns_483.parquet",
                    "{dir_in}/txns_484.parquet",
                    "{dir_in}/txns_485.parquet",
                    "{dir_in}/txns_486.parquet",
                    "{dir_in}/txns_487.parquet",
                    "{dir_in}/txns_488.parquet",
                    "{dir_in}/txns_489.parquet",
                    "{dir_in}/txns_490.parquet",
                    "{dir_in}/txns_491.parquet",
                    "{dir_in}/txns_492.parquet",
                    "{dir_in}/txns_493.parquet",
                    "{dir_in}/txns_494.parquet",
                    "{dir_in}/txns_495.parquet",
                    "{dir_in}/txns_496.parquet",
                    "{dir_in}/txns_497.parquet",
                    "{dir_in}/txns_498.parquet",
                    "{dir_in}/txns_499.parquet",
                    "{dir_in}/txns_500.parquet",
                    "{dir_in}/txns_501.parquet",
                    "{dir_in}/txns_502.parquet",
                    "{dir_in}/txns_503.parquet",
                    "{dir_in}/txns_504.parquet",
                    "{dir_in}/txns_505.parquet",
                    "{dir_in}/txns_506.parquet",
                    "{dir_in}/txns_507.parquet",
                    "{dir_in}/txns_508.parquet",
                    "{dir_in}/txns_509.parquet",
                    "{dir_in}/txns_510.parquet",
                    "{dir_in}/txns_511.parquet",
                    "{dir_in}/txns_512.parquet",
                    "{dir_in}/txns_513.parquet",
                    "{dir_in}/txns_514.parquet",
                    "{dir_in}/txns_515.parquet",
                    "{dir_in}/txns_516.parquet",
                    "{dir_in}/txns_517.parquet",
                    "{dir_in}/txns_518.parquet",
                    "{dir_in}/txns_519.parquet",
                    "{dir_in}/txns_520.parquet",
                    "{dir_in}/txns_521.parquet",
                    "{dir_in}/txns_522.parquet",
                    "{dir_in}/txns_523.parquet",
                    "{dir_in}/txns_524.parquet",
                    "{dir_in}/txns_525.parquet",
                    "{dir_in}/txns_526.parquet",
                    "{dir_in}/txns_527.parquet",
                    "{dir_in}/txns_528.parquet",
                    "{dir_in}/txns_529.parquet",
                    "{dir_in}/txns_530.parquet",
                    "{dir_in}/txns_531.parquet",
                    "{dir_in}/txns_532.parquet",
                    "{dir_in}/txns_533.parquet",
                    "{dir_in}/txns_534.parquet",
                    "{dir_in}/txns_535.parquet",
                    "{dir_in}/txns_536.parquet",
                    "{dir_in}/txns_537.parquet",
                    "{dir_in}/txns_538.parquet",
                    "{dir_in}/txns_539.parquet",
                    "{dir_in}/txns_540.parquet",
                    "{dir_in}/txns_541.parquet",
                    "{dir_in}/txns_542.parquet",
                    "{dir_in}/txns_543.parquet",
                    "{dir_in}/txns_544.parquet",
                    "{dir_in}/txns_545.parquet",
                    "{dir_in}/txns_546.parquet",
                    "{dir_in}/txns_547.parquet",
                    "{dir_in}/txns_548.parquet",
                    "{dir_in}/txns_549.parquet",
                    "{dir_in}/txns_550.parquet",
                    "{dir_in}/txns_551.parquet",
                    "{dir_in}/txns_552.parquet",
                    "{dir_in}/txns_553.parquet",
                    "{dir_in}/txns_554.parquet",
                    "{dir_in}/txns_555.parquet",
                    "{dir_in}/txns_556.parquet",
                    "{dir_in}/txns_557.parquet",
                    "{dir_in}/txns_558.parquet",
                    "{dir_in}/txns_559.parquet",
                    "{dir_in}/txns_560.parquet",
                    "{dir_in}/txns_561.parquet",
                    "{dir_in}/txns_562.parquet",
                    "{dir_in}/txns_563.parquet",
                    "{dir_in}/txns_564.parquet",
                    "{dir_in}/txns_565.parquet",
                    "{dir_in}/txns_566.parquet",
                    "{dir_in}/txns_567.parquet",
                    "{dir_in}/txns_568.parquet",
                    "{dir_in}/txns_569.parquet",
                    "{dir_in}/txns_570.parquet",
                    "{dir_in}/txns_571.parquet",
                    "{dir_in}/txns_572.parquet",
                    "{dir_in}/txns_573.parquet",
                    "{dir_in}/txns_574.parquet",
                    "{dir_in}/txns_575.parquet",
                    "{dir_in}/txns_576.parquet",
                    "{dir_in}/txns_577.parquet",
                    "{dir_in}/txns_578.parquet",
                    "{dir_in}/txns_579.parquet",
                    "{dir_in}/txns_580.parquet",
                    "{dir_in}/txns_581.parquet",
                    "{dir_in}/txns_582.parquet",
                    "{dir_in}/txns_583.parquet",
                    "{dir_in}/txns_584.parquet",
                    "{dir_in}/txns_585.parquet",
                    "{dir_in}/txns_586.parquet",
                    "{dir_in}/txns_587.parquet",
                    "{dir_in}/txns_588.parquet",
                    "{dir_in}/txns_589.parquet",
                    "{dir_in}/txns_590.parquet",
                    "{dir_in}/txns_591.parquet",
                    "{dir_in}/txns_592.parquet",
                    "{dir_in}/txns_593.parquet",
                    "{dir_in}/txns_594.parquet",
                    "{dir_in}/txns_595.parquet",
                    "{dir_in}/txns_596.parquet",
                    "{dir_in}/txns_597.parquet",
                    "{dir_in}/txns_598.parquet",
                    "{dir_in}/txns_599.parquet",
                    "{dir_in}/txns_600.parquet",
                    "{dir_in}/txns_601.parquet",
                    "{dir_in}/txns_602.parquet",
                    "{dir_in}/txns_603.parquet",
                    "{dir_in}/txns_604.parquet",
                    "{dir_in}/txns_605.parquet",
                    "{dir_in}/txns_606.parquet",
                    "{dir_in}/txns_607.parquet",
                    "{dir_in}/txns_608.parquet",
                    "{dir_in}/txns_609.parquet",
                    "{dir_in}/txns_610.parquet",
                    "{dir_in}/txns_611.parquet",
                    "{dir_in}/txns_612.parquet",
                    "{dir_in}/txns_613.parquet",
                    "{dir_in}/txns_614.parquet",
                    "{dir_in}/txns_615.parquet",
                    "{dir_in}/txns_616.parquet",
                    "{dir_in}/txns_617.parquet",
                    "{dir_in}/txns_618.parquet",
                    "{dir_in}/txns_619.parquet",
                    "{dir_in}/txns_620.parquet",
                    "{dir_in}/txns_621.parquet",
                    "{dir_in}/txns_622.parquet",
                    "{dir_in}/txns_623.parquet",
                    "{dir_in}/txns_624.parquet",
                    "{dir_in}/txns_625.parquet",
                    "{dir_in}/txns_626.parquet",
                    "{dir_in}/txns_627.parquet",
                    "{dir_in}/txns_628.parquet",
                    "{dir_in}/txns_629.parquet",
                    "{dir_in}/txns_630.parquet",
                    "{dir_in}/txns_631.parquet",
                    "{dir_in}/txns_632.parquet",
                    "{dir_in}/txns_633.parquet",
                    "{dir_in}/txns_634.parquet",
                    "{dir_in}/txns_635.parquet",
                    "{dir_in}/txns_636.parquet",
                    "{dir_in}/txns_637.parquet",
                    "{dir_in}/txns_638.parquet",
                    "{dir_in}/txns_639.parquet",
                    "{dir_in}/txns_640.parquet",
                    "{dir_in}/txns_641.parquet",
                    "{dir_in}/txns_642.parquet",
                    "{dir_in}/txns_643.parquet",
                    "{dir_in}/txns_644.parquet",
                    "{dir_in}/txns_645.parquet",
                    "{dir_in}/txns_646.parquet",
                    "{dir_in}/txns_647.parquet",
                    "{dir_in}/txns_648.parquet",
                    "{dir_in}/txns_649.parquet",
                    "{dir_in}/txns_650.parquet",
                    "{dir_in}/txns_651.parquet",
                    "{dir_in}/txns_652.parquet",
                    "{dir_in}/txns_653.parquet",
                    "{dir_in}/txns_654.parquet",
                    "{dir_in}/txns_655.parquet",
                    "{dir_in}/txns_656.parquet",
                    "{dir_in}/txns_657.parquet",
                    "{dir_in}/txns_658.parquet",
                    "{dir_in}/txns_659.parquet",
                    "{dir_in}/txns_660.parquet",
                    "{dir_in}/txns_661.parquet",
                    "{dir_in}/txns_662.parquet",
                    "{dir_in}/txns_663.parquet",
                    "{dir_in}/txns_664.parquet",
                    "{dir_in}/txns_665.parquet",
                    "{dir_in}/txns_666.parquet",
                    "{dir_in}/txns_667.parquet",
                    "{dir_in}/txns_668.parquet",
                    "{dir_in}/txns_669.parquet",
                    "{dir_in}/txns_670.parquet",
                    "{dir_in}/txns_671.parquet",
                    "{dir_in}/txns_672.parquet",
                    "{dir_in}/txns_673.parquet",
                    "{dir_in}/txns_674.parquet",
                    "{dir_in}/txns_675.parquet",
                    "{dir_in}/txns_676.parquet",
                    "{dir_in}/txns_677.parquet",
                    "{dir_in}/txns_678.parquet",
                    "{dir_in}/txns_679.parquet",
                    "{dir_in}/txns_680.parquet",
                    "{dir_in}/txns_681.parquet",
                    "{dir_in}/txns_682.parquet",
                    "{dir_in}/txns_683.parquet",
                    "{dir_in}/txns_684.parquet",
                    "{dir_in}/txns_685.parquet",
                    "{dir_in}/txns_686.parquet",
                    "{dir_in}/txns_687.parquet",
                    "{dir_in}/txns_688.parquet",
                    "{dir_in}/txns_689.parquet",
                    "{dir_in}/txns_690.parquet",
                    "{dir_in}/txns_691.parquet",
                    "{dir_in}/txns_692.parquet",
                    "{dir_in}/txns_693.parquet",
                    "{dir_in}/txns_694.parquet",
                    "{dir_in}/txns_695.parquet",
                    "{dir_in}/txns_696.parquet",
                    "{dir_in}/txns_697.parquet",
                    "{dir_in}/txns_698.parquet",
                    "{dir_in}/txns_699.parquet",
                    "{dir_in}/txns_700.parquet",
                    "{dir_in}/txns_701.parquet",
                    "{dir_in}/txns_702.parquet",
                    "{dir_in}/txns_703.parquet",
                    "{dir_in}/txns_704.parquet",
                    "{dir_in}/txns_705.parquet",
                    "{dir_in}/txns_706.parquet",
                    "{dir_in}/txns_707.parquet",
                    "{dir_in}/txns_708.parquet",
                    "{dir_in}/txns_709.parquet",
                    "{dir_in}/txns_710.parquet",
                    "{dir_in}/txns_711.parquet",
                    "{dir_in}/txns_712.parquet",
                    "{dir_in}/txns_713.parquet",
                    "{dir_in}/txns_714.parquet",
                    "{dir_in}/txns_715.parquet",
                    "{dir_in}/txns_716.parquet",
                    "{dir_in}/txns_717.parquet",
                    "{dir_in}/txns_718.parquet",
                    "{dir_in}/txns_719.parquet",
                    "{dir_in}/txns_720.parquet",
                    "{dir_in}/txns_721.parquet",
                    "{dir_in}/txns_722.parquet",
                    "{dir_in}/txns_723.parquet",
                    "{dir_in}/txns_724.parquet",
                    "{dir_in}/txns_725.parquet",
                    "{dir_in}/txns_726.parquet",
                    "{dir_in}/txns_727.parquet",
                    "{dir_in}/txns_728.parquet",
                    "{dir_in}/txns_729.parquet",
                    "{dir_in}/txns_730.parquet",
                    "{dir_in}/txns_731.parquet",
                    "{dir_in}/txns_732.parquet",
                    "{dir_in}/txns_733.parquet",
                    "{dir_in}/txns_734.parquet",
                    "{dir_in}/txns_735.parquet",
                    "{dir_in}/txns_736.parquet",
                    "{dir_in}/txns_737.parquet",
                    "{dir_in}/txns_738.parquet",
                    "{dir_in}/txns_739.parquet",
                    "{dir_in}/txns_740.parquet",
                    "{dir_in}/txns_741.parquet",
                    "{dir_in}/txns_742.parquet",
                    "{dir_in}/txns_743.parquet",
                    "{dir_in}/txns_744.parquet",
                    "{dir_in}/txns_745.parquet",
                    "{dir_in}/txns_746.parquet",
                    "{dir_in}/txns_747.parquet",
                    "{dir_in}/txns_748.parquet",
                    "{dir_in}/txns_749.parquet",
                    "{dir_in}/txns_750.parquet",
                    "{dir_in}/txns_751.parquet",
                    "{dir_in}/txns_752.parquet",
                    "{dir_in}/txns_753.parquet",
                    "{dir_in}/txns_754.parquet",
                    "{dir_in}/txns_755.parquet",
                    "{dir_in}/txns_756.parquet",
                    "{dir_in}/txns_757.parquet",
                    "{dir_in}/txns_758.parquet",
                    "{dir_in}/txns_759.parquet",
                    "{dir_in}/txns_760.parquet",
                    "{dir_in}/txns_761.parquet",
                    "{dir_in}/txns_762.parquet",
                    "{dir_in}/txns_763.parquet",
                    "{dir_in}/txns_764.parquet",
                    "{dir_in}/txns_765.parquet",
                    "{dir_in}/txns_766.parquet",
                    "{dir_in}/txns_767.parquet",
                    "{dir_in}/txns_768.parquet",
                    "{dir_in}/txns_769.parquet",
                    "{dir_in}/txns_770.parquet",
                    "{dir_in}/txns_771.parquet",
                    "{dir_in}/txns_772.parquet",
                    "{dir_in}/txns_773.parquet",
                    "{dir_in}/txns_774.parquet",
                    "{dir_in}/txns_775.parquet",
                    "{dir_in}/txns_776.parquet",
                    "{dir_in}/txns_777.parquet",
                    "{dir_in}/txns_778.parquet",
                    "{dir_in}/txns_779.parquet",
                    "{dir_in}/txns_780.parquet",
                    "{dir_in}/txns_781.parquet",
                    "{dir_in}/txns_782.parquet",
                    "{dir_in}/txns_783.parquet",
                    "{dir_in}/txns_784.parquet",
                    "{dir_in}/txns_785.parquet",
                    "{dir_in}/txns_786.parquet",
                    "{dir_in}/txns_787.parquet",
                    "{dir_in}/txns_788.parquet",
                    "{dir_in}/txns_789.parquet",
                    "{dir_in}/txns_790.parquet",
                    "{dir_in}/txns_791.parquet",
                    "{dir_in}/txns_792.parquet",
                    "{dir_in}/txns_793.parquet",
                    "{dir_in}/txns_794.parquet",
                    "{dir_in}/txns_795.parquet",
                    "{dir_in}/txns_796.parquet",
                    "{dir_in}/txns_797.parquet",
                    "{dir_in}/txns_798.parquet",
                    "{dir_in}/txns_799.parquet",
                    "{dir_in}/txns_800.parquet",
                    "{dir_in}/txns_801.parquet",
                    "{dir_in}/txns_802.parquet",
                    "{dir_in}/txns_803.parquet",
                    "{dir_in}/txns_804.parquet",
                    "{dir_in}/txns_805.parquet",
                    "{dir_in}/txns_806.parquet",
                    "{dir_in}/txns_807.parquet",
                    "{dir_in}/txns_808.parquet",
                    "{dir_in}/txns_809.parquet",
                    "{dir_in}/txns_810.parquet",
                    "{dir_in}/txns_811.parquet",
                    "{dir_in}/txns_812.parquet",
                    "{dir_in}/txns_813.parquet",
                    "{dir_in}/txns_814.parquet",
                    "{dir_in}/txns_815.parquet",
                    "{dir_in}/txns_816.parquet",
                    "{dir_in}/txns_817.parquet",
                    "{dir_in}/txns_818.parquet",
                    "{dir_in}/txns_819.parquet",
                    "{dir_in}/txns_820.parquet",
                    "{dir_in}/txns_821.parquet",
                    "{dir_in}/txns_822.parquet",
                    "{dir_in}/txns_823.parquet",
                    "{dir_in}/txns_824.parquet",
                    "{dir_in}/txns_825.parquet",
                    "{dir_in}/txns_826.parquet",
                    "{dir_in}/txns_827.parquet",
                    "{dir_in}/txns_828.parquet",
                    "{dir_in}/txns_829.parquet",
                    "{dir_in}/txns_830.parquet",
                    "{dir_in}/txns_831.parquet",
                    "{dir_in}/txns_832.parquet",
                    "{dir_in}/txns_833.parquet",
                    "{dir_in}/txns_834.parquet",
                    "{dir_in}/txns_835.parquet",
                    "{dir_in}/txns_836.parquet",
                    "{dir_in}/txns_837.parquet",
                    "{dir_in}/txns_838.parquet",
                    "{dir_in}/txns_839.parquet",
                    "{dir_in}/txns_840.parquet",
                    "{dir_in}/txns_841.parquet",
                    "{dir_in}/txns_842.parquet",
                    "{dir_in}/txns_843.parquet",
                    "{dir_in}/txns_844.parquet",
                    "{dir_in}/txns_845.parquet",
                    "{dir_in}/txns_846.parquet",
                    "{dir_in}/txns_847.parquet",
                    "{dir_in}/txns_848.parquet",
                    "{dir_in}/txns_849.parquet",
                    "{dir_in}/txns_850.parquet",
                    "{dir_in}/txns_851.parquet",
                    "{dir_in}/txns_852.parquet",
                    "{dir_in}/txns_853.parquet",
                    "{dir_in}/txns_854.parquet",
                    "{dir_in}/txns_855.parquet",
                    "{dir_in}/txns_856.parquet",
                    "{dir_in}/txns_857.parquet",
                    "{dir_in}/txns_858.parquet",
                    "{dir_in}/txns_859.parquet",
                    "{dir_in}/txns_860.parquet",
                    "{dir_in}/txns_861.parquet",
                    "{dir_in}/txns_862.parquet",
                    "{dir_in}/txns_863.parquet",
                    "{dir_in}/txns_864.parquet",
                    "{dir_in}/txns_865.parquet",
                    "{dir_in}/txns_866.parquet",
                    "{dir_in}/txns_867.parquet",
                    "{dir_in}/txns_868.parquet",
                    "{dir_in}/txns_869.parquet",
                    "{dir_in}/txns_870.parquet",
                    "{dir_in}/txns_871.parquet",
                    "{dir_in}/txns_872.parquet",
                    "{dir_in}/txns_873.parquet",
                    "{dir_in}/txns_874.parquet",
                    "{dir_in}/txns_875.parquet",
                    "{dir_in}/txns_876.parquet",
                    "{dir_in}/txns_877.parquet",
                    "{dir_in}/txns_878.parquet",
                    "{dir_in}/txns_879.parquet",
                    "{dir_in}/txns_880.parquet",
                    "{dir_in}/txns_881.parquet",
                    "{dir_in}/txns_882.parquet",
                    "{dir_in}/txns_883.parquet",
                    "{dir_in}/txns_884.parquet",
                    "{dir_in}/txns_885.parquet",
                    "{dir_in}/txns_886.parquet",
                    "{dir_in}/txns_887.parquet",
                    "{dir_in}/txns_888.parquet",
                    "{dir_in}/txns_889.parquet",
                    "{dir_in}/txns_890.parquet",
                    "{dir_in}/txns_891.parquet",
                    "{dir_in}/txns_892.parquet",
                    "{dir_in}/txns_893.parquet",
                    "{dir_in}/txns_894.parquet",
                    "{dir_in}/txns_895.parquet",
                    "{dir_in}/txns_896.parquet",
                    "{dir_in}/txns_897.parquet",
                    "{dir_in}/txns_898.parquet",
                    "{dir_in}/txns_899.parquet",
                    "{dir_in}/txns_900.parquet",
                    "{dir_in}/txns_901.parquet",
                    "{dir_in}/txns_902.parquet",
                    "{dir_in}/txns_903.parquet",
                    "{dir_in}/txns_904.parquet",
                    "{dir_in}/txns_905.parquet",
                    "{dir_in}/txns_906.parquet",
                    "{dir_in}/txns_907.parquet",
                    "{dir_in}/txns_908.parquet",
                    "{dir_in}/txns_909.parquet",
                    "{dir_in}/txns_910.parquet",
                    "{dir_in}/txns_911.parquet",
                    "{dir_in}/txns_912.parquet",
                    "{dir_in}/txns_913.parquet",
                    "{dir_in}/txns_914.parquet",
                    "{dir_in}/txns_915.parquet",
                    "{dir_in}/txns_916.parquet",
                    "{dir_in}/txns_917.parquet",
                    "{dir_in}/txns_918.parquet",
                    "{dir_in}/txns_919.parquet",
                    "{dir_in}/txns_920.parquet",
                    "{dir_in}/txns_921.parquet",
                    "{dir_in}/txns_922.parquet",
                    "{dir_in}/txns_923.parquet",
                    "{dir_in}/txns_924.parquet",
                    "{dir_in}/txns_925.parquet",
                    "{dir_in}/txns_926.parquet",
                    "{dir_in}/txns_927.parquet",
                    "{dir_in}/txns_928.parquet",
                    "{dir_in}/txns_929.parquet",
                    "{dir_in}/txns_930.parquet",
                    "{dir_in}/txns_931.parquet",
                    "{dir_in}/txns_932.parquet",
                    "{dir_in}/txns_933.parquet",
                    "{dir_in}/txns_934.parquet",
                    "{dir_in}/txns_935.parquet",
                    "{dir_in}/txns_936.parquet",
                    "{dir_in}/txns_937.parquet",
                    "{dir_in}/txns_938.parquet",
                    "{dir_in}/txns_939.parquet",
                    "{dir_in}/txns_940.parquet",
                    "{dir_in}/txns_941.parquet",
                    "{dir_in}/txns_942.parquet",
                    "{dir_in}/txns_943.parquet",
                    "{dir_in}/txns_944.parquet",
                    "{dir_in}/txns_945.parquet",
                    "{dir_in}/txns_946.parquet",
                    "{dir_in}/txns_947.parquet",
                    "{dir_in}/txns_948.parquet",
                    "{dir_in}/txns_949.parquet",
                    "{dir_in}/txns_950.parquet",
                    "{dir_in}/txns_951.parquet",
                    "{dir_in}/txns_952.parquet",
                    "{dir_in}/txns_953.parquet",
                    "{dir_in}/txns_954.parquet",
                    "{dir_in}/txns_955.parquet",
                    "{dir_in}/txns_956.parquet",
                    "{dir_in}/txns_957.parquet",
                    "{dir_in}/txns_958.parquet",
                    "{dir_in}/txns_959.parquet",
                    "{dir_in}/txns_960.parquet",
                    "{dir_in}/txns_961.parquet",
                    "{dir_in}/txns_962.parquet",
                    "{dir_in}/txns_963.parquet",
                    "{dir_in}/txns_964.parquet",
                    "{dir_in}/txns_965.parquet",
                    "{dir_in}/txns_966.parquet",
                    "{dir_in}/txns_967.parquet",
                    "{dir_in}/txns_968.parquet",
                    "{dir_in}/txns_969.parquet",
                    "{dir_in}/txns_970.parquet",
                    "{dir_in}/txns_971.parquet",
                    "{dir_in}/txns_972.parquet",
                    "{dir_in}/txns_973.parquet",
                    "{dir_in}/txns_974.parquet",
                    "{dir_in}/txns_975.parquet",
                    "{dir_in}/txns_976.parquet",
                    "{dir_in}/txns_977.parquet",
                    "{dir_in}/txns_978.parquet",
                    "{dir_in}/txns_979.parquet",
                    "{dir_in}/txns_980.parquet",
                    "{dir_in}/txns_981.parquet",
                    "{dir_in}/txns_982.parquet",
                    "{dir_in}/txns_983.parquet",
                    "{dir_in}/txns_984.parquet",
                    "{dir_in}/txns_985.parquet",
                    "{dir_in}/txns_986.parquet",
                    "{dir_in}/txns_987.parquet",
                    "{dir_in}/txns_988.parquet",
                    "{dir_in}/txns_989.parquet",
                    "{dir_in}/txns_990.parquet",
                    "{dir_in}/txns_991.parquet",
                    "{dir_in}/txns_992.parquet",
                    "{dir_in}/txns_993.parquet",
                    "{dir_in}/txns_994.parquet",
                    "{dir_in}/txns_995.parquet",
                    "{dir_in}/txns_996.parquet",
                    "{dir_in}/txns_997.parquet",
                    "{dir_in}/txns_998.parquet",
                    "{dir_in}/txns_999.parquet"
                ],
                "columns": {
                    "col_ts": {
                        "parquet": {
                            "col_name": "ts"
                        },
                        "col_type": "datetime"
                    },
                    "col_account_id": {
                        "parquet": {
                            "col_name": "account_id"
                        },
                        "col_type": "string"
                    },
                    "col_ticker": {
                        "parquet": {
                            "col_name": "ticker"
                        },
                        "col_type": "string"
                    },
                    "col_qty": {
                        "parquet": {
                            "col_name": "qty"
                        },
                        "col_type": "int"
                    },
                    "col_price": {
                        "parquet": {
                            "col_name": "price"
                        },
                        "col_type": "float"
                    }
                }
            },
            "w": {
                "name": "txns",
                "table_options": "{aws_keyspaces_table_options}",
                "having": "time.After(w.ts,time.Parse(`2006-01-02`,`{period_start_eod}`)) && !time.After(w.ts,time.Parse(`2006-01-02`,`{period_end_eod}`))",
                "fields": {
                    "account_id": {
                        "expression": "r.col_account_id",
                        "type": "string"
                    },
                    "ts": {
                        "expression": "r.col_ts",
                        "type": "datetime"
                    },
                    "txn_json": {
                        "expression": "fmt.Sprintf(`\"%s|%s|%d|%s\"`, time.Format(r.col_ts, `2006-01-02`), r.col_ticker, r.col_qty, decimal2(r.col_price))",
                        "type": "string"
                    }
                },
                "indexes": {
                    "idx_txns_account_id": "non_unique(account_id)"
                }
            }
        },
        "2_account_txns_outer": {
            "type": "table_lookup_table",
            "desc": "For each account, merge all txns into single json string",
            "start_policy": "{manual_if_multi}",
            "r": {
                "table": "accounts",
                "expected_batches_total": 1000
            },
            "l": {
                "index_name": "idx_txns_account_id",
                "join_on": "r.account_id",
                "group": true,
                "join_type": "left"
            },
            "w": {
                "name": "account_txns",
                "table_options": "",
                "fields": {
                    "account_id": {
                        "expression": "r.account_id",
                        "type": "string"
                    },
                    "txns_json": {
                        "expression": "string_agg(l.txn_json,\",\")",
                        "type": "string"
                    }
                }
            }
        },
        "1_read_period_holdings": {
            "type": "file_table",
            "desc": "Load holdings from parquet",
            "r": {
                "urls": [
                    "{dir_in}/holdings_000.parquet",
                    "{dir_in}/holdings_001.parquet",
                    "{dir_in}/holdings_002.parquet",
                    "{dir_in}/holdings_003.parquet",
                    "{dir_in}/holdings_004.parquet",
                    "{dir_in}/holdings_005.parquet",
                    "{dir_in}/holdings_006.parquet",
                    "{dir_in}/holdings_007.parquet",
                    "{dir_in}/holdings_008.parquet",
                    "{dir_in}/holdings_009.parquet",
                    "{dir_in}/holdings_010.parquet",
                    "{dir_in}/holdings_011.parquet",
                    "{dir_in}/holdings_012.parquet",
                    "{dir_in}/holdings_013.parquet",
                    "{dir_in}/holdings_014.parquet",
                    "{dir_in}/holdings_015.parquet",
                    "{dir_in}/holdings_016.parquet",
                    "{dir_in}/holdings_017.parquet",
                    "{dir_in}/holdings_018.parquet",
                    "{dir_in}/holdings_019.parquet",
                    "{dir_in}/holdings_020.parquet",
                    "{dir_in}/holdings_021.parquet",
                    "{dir_in}/holdings_022.parquet",
                    "{dir_in}/holdings_023.parquet",
                    "{dir_in}/holdings_024.parquet",
                    "{dir_in}/holdings_025.parquet",
                    "{dir_in}/holdings_026.parquet",
                    "{dir_in}/holdings_027.parquet",
                    "{dir_in}/holdings_028.parquet",
                    "{dir_in}/holdings_029.parquet",
                    "{dir_in}/holdings_030.parquet",
                    "{dir_in}/holdings_031.parquet",
                    "{dir_in}/holdings_032.parquet",
                    "{dir_in}/holdings_033.parquet",
                    "{dir_in}/holdings_034.parquet",
                    "{dir_in}/holdings_035.parquet",
                    "{dir_in}/holdings_036.parquet",
                    "{dir_in}/holdings_037.parquet",
                    "{dir_in}/holdings_038.parquet",
                    "{dir_in}/holdings_039.parquet",
                    "{dir_in}/holdings_040.parquet",
                    "{dir_in}/holdings_041.parquet",
                    "{dir_in}/holdings_042.parquet",
                    "{dir_in}/holdings_043.parquet",
                    "{dir_in}/holdings_044.parquet",
                    "{dir_in}/holdings_045.parquet",
                    "{dir_in}/holdings_046.parquet",
                    "{dir_in}/holdings_047.parquet",
                    "{dir_in}/holdings_048.parquet",
                    "{dir_in}/holdings_049.parquet"
                ],
                "columns": {
                    "col_eod": {
                        "parquet": {
                            "col_name": "d"
                        },
                        "col_type": "datetime"
                    },
                    "col_account_id": {
                        "parquet": {
                            "col_name": "account_id"
                        },
                        "col_type": "string"
                    },
                    "col_ticker": {
                        "parquet": {
                            "col_name": "ticker"
                        },
                        "col_type": "string"
                    },
                    "col_qty": {
                        "parquet": {
                            "col_name": "qty"
                        },
                        "col_type": "int"
                    }
                }
            },
            "w": {
                "name": "period_holdings",
                "table_options": "{aws_keyspaces_table_options}",
                "having": "!time.After(time.Parse(`2006-01-02`,`{period_start_eod}`),w.eod) && !time.After(w.eod,time.Parse(`2006-01-02`,`{period_end_eod}`))",

                "fields": {
                    "account_id": {
                        "expression": "r.col_account_id",
                        "type": "string"
                    },
                    "eod": {
                        "expression": "r.col_eod",
                        "type": "datetime"
                    },
                    "holding_json": {
                        "expression": "fmt.Sprintf(`\"%s|%s|%d\"`, time.Format(r.col_eod, `2006-01-02`), r.col_ticker, r.col_qty)",
                        "type": "string"
                    }
                },
                "indexes": {
                    "idx_period_holdings_account_id": "non_unique(account_id)"
                }
            }
        },
        "2_account_period_holdings_outer": {
            "type": "table_lookup_table",
            "desc": "For each account, merge all holdings into single json string",
            "start_policy": "{manual_if_multi}",
            "r": {
                "table": "accounts",
                "expected_batches_total": 50
            },
            "l": {
                "index_name": "idx_period_holdings_account_id",
                "join_on": "r.account_id",
                "group": true,
                "join_type": "left"
            },
            "w": {
                "name": "account_period_holdings",
                "table_options": "",
                "fields": {
                    "account_id": {
                        "expression": "r.account_id",
                        "type": "string"
                    },
                    "holdings_json": {
                        "expression": "string_agg(l.holding_json,\",\")",
                        "type": "string"
                    }
                },
                "indexes": {
                    "idx_account_period_holdings_account_id": "unique(account_id)"
                }
            }
        },
        "3_build_account_period_activity": {
            "type": "table_lookup_table",
            "desc": "For each account, merge holdings and txns",
            "start_policy": "{manual_if_multi}",
            "r": {
                "table": "account_txns",
                "expected_batches_total": 10
            },
            "l": {
                "index_name": "idx_account_period_holdings_account_id",
                "join_on": "r.account_id",
                "group": false,
                "join_type": "left"
            },
            "w": {
                "name": "account_period_activity",
                "table_options": "",
                "fields": {
                    "account_id": {
                        "expression": "r.account_id",
                        "type": "string"
                    },
                    "txns_json": {
                        "expression": " \"[\" + r.txns_json + \"]\" ",
                        "type": "string"
                    },
                    "holdings_json": {
                        "expression": " \"[\" + l.holdings_json + \"]\" ",
                        "type": "string"
                    }
                }
            }
        },
        "4_calc_account_period_perf": {
            "type": "table_custom_tfm_table",
            "custom_proc_type": "py_calc",
            "desc": "Apply Python-based calculations to account holdings and txns",
            "r": {
                "table": "account_period_activity",
                "expected_batches_total": 500            },
            "p": {
                "python_code_urls": [
                    "{dir_py}/portfolio_test_company_info_provider.py",
                    "{dir_py}/portfolio_test_eod_price_provider.py",
                    "{dir_py}/portfolio_calc.py"
                ],
                "calculated_fields": {
                    "perf_json": {
                        "expression": "txns_and_holdings_to_twr_cagr_by_sector_year_quarter_json(\"{period_start_eod}\", \"{period_end_eod}\", r.holdings_json, r.txns_json, PortfolioTestEodPriceProvider, PortfolioTestCompanyInfoProvider)",
                        "type": "string"
                    }
                }
            },
            "w": {
                "name": "account_period_perf",
                "table_options": "",
                "fields": {
                    "account_id": {
                        "expression": "r.account_id",
                        "type": "string"
                    },
                    "perf_json": {
                        "expression": "p.perf_json",
                        "type": "string"
                    }
                }
            }
        },
        "5_tag_by_period": {
            "type": "table_custom_tfm_table",
            "custom_proc_type": "tag_and_denormalize",
            "desc": "Tag accounts by period name",
            "start_policy": "{manual_if_multi}",
            "r": {
                "table": "account_period_perf",
                "expected_batches_total": 10
            },
            "p": {
                "tag_field_name": "period",
                "tag_criteria": {
                    "2021": "re.MatchString(`\"2021\":`, r.perf_json)",
                    "2021Q1": "re.MatchString(`\"2021Q1\":`, r.perf_json)",
                    "2021Q2": "re.MatchString(`\"2021Q2\":`, r.perf_json)",
                    "2021Q3": "re.MatchString(`\"2021Q3\":`, r.perf_json)",
                    "2021Q4": "re.MatchString(`\"2021Q4\":`, r.perf_json)",
                    "2022": "re.MatchString(`\"2022\":`, r.perf_json)",
                    "2022Q1": "re.MatchString(`\"2022Q1\":`, r.perf_json)",
                    "2022Q2": "re.MatchString(`\"2022Q2\":`, r.perf_json)",
                    "2022Q3": "re.MatchString(`\"2022Q3\":`, r.perf_json)",
                    "2022Q4": "re.MatchString(`\"2022Q4\":`, r.perf_json)"
                }
            },
            "w": {
                "name": "account_period_perf_by_period",
                "table_options": "",
                "fields": {
                    "period": {
                        "expression": "p.period",
                        "type": "string"
                    },
                    "account_id": {
                        "expression": "r.account_id",
                        "type": "string"
                    },
                    "perf_json": {
                        "expression": "r.perf_json",
                        "type": "string"
                    }
                }
            }
        },
        "5_tag_by_sector": {
            "type": "table_custom_tfm_table",
            "custom_proc_type": "tag_and_denormalize",
            "desc": "Tag accounts by sector",
            "r": {
                "table": "account_period_perf_by_period",
                "expected_batches_total": 10
            },
            "p": {
                "tag_field_name": "sector",
                "tag_criteria": {
                    "All": "re.MatchString(`\"All\":`, r.perf_json)",
                    "Communication Services": "re.MatchString(`\"Communication Services\":`, r.perf_json)",
                    "Consumer Cyclical": "re.MatchString(`\"Consumer Cyclical\":`, r.perf_json)",
                    "Consumer Defensive": "re.MatchString(`\"Consumer Defensive\":`, r.perf_json)",
                    "Financial Services": "re.MatchString(`\"Financial Services\":`, r.perf_json)",
                    "Healthcare": "re.MatchString(`\"Healthcare\":`, r.perf_json)",
                    "Industrials": "re.MatchString(`\"Industrials\":`, r.perf_json)",
                    "Real Estate": "re.MatchString(`\"Real Estate\":`, r.perf_json)",
                    "Technology": "re.MatchString(`\"Technology\":`, r.perf_json)"
                }
            },
            "w": {
                "name": "account_period_perf_by_period_sector",
                "table_options": "",
                "fields": {
                    "period": {
                        "expression": "r.period",
                        "type": "string"
                    },
                    "sector": {
                        "expression": "p.sector",
                        "type": "string"
                    },
                    "account_id": {
                        "expression": "r.account_id",
                        "type": "string"
                    },
                    "perf_json": {
                        "expression": "r.perf_json",
                        "type": "string"
                    }
                }
            }
        },
        "6_perf_json_to_columns": {
            "type": "table_custom_tfm_table",
            "custom_proc_type": "py_calc",
            "desc": "Use Python to read perf json and save stats as columns",
            "r": {
                "table": "account_period_perf_by_period_sector",
                "expected_batches_total": 100
            },
            "p": {
                "python_code_urls": [
                    "{dir_py}/json_to_columns.py"
                ],
                "calculated_fields": {
                    "twr": {
                        "expression": "json_to_twr(r.perf_json, r.period, r.sector)",
                        "type": "float"
                    },
                    "cagr": {
                        "expression": "json_to_cagr(r.perf_json, r.period, r.sector)",
                        "type": "float"
                    }
                }
            },
            "w": {
                "name": "account_period_sector_twr_cagr",
                "table_options": "",
                "fields": {
                    "account_id": {
                        "expression": "r.account_id",
                        "type": "string"
                    },
                    "period": {
                        "expression": "r.period",
                        "type": "string"
                    },
                    "sector": {
                        "expression": "r.sector",
                        "type": "string"
                    },
                    "twr": {
                        "expression": "p.twr",
                        "type": "float"
                    },
                    "cagr": {
                        "expression": "p.cagr",
                        "type": "float"
                    }
                }
            }
        },
        "7_file_account_period_sector_perf": {
            "type": "table_file",
            "desc": "Write yearly/quarterly perf results by sector to parquet file",
            "r": {
                "table": "account_period_sector_twr_cagr"
            },
            "w": {
                "top": {
                    "order": "account_id,period,sector"
                },
                "url_template": "{dir_out}/account_period_sector_perf.parquet",
                "columns": [
                    {
                        "parquet": {
                            "column_name": "ARK fund"
                        },
                        "name": "account_id",
                        "expression": "r.account_id",
                        "type": "string"
                    },
                    {
                        "parquet": {
                            "column_name": "Period"
                        },
                        "name": "period",
                        "expression": "r.period",
                        "type": "string"
                    },
                    {
                        "parquet": {
                            "column_name": "Sector"
                        },
                        "name": "sector",
                        "expression": "r.sector",
                        "type": "string"
                    },
                    {
                        "parquet": {
                            "column_name": "Time-weighted annualized return %"
                        },
                        "name": "cagr",
                        "expression": "math.Round(r.cagr*100)/100",
                        "type": "float"
                    }
                ]
            }
        },
        "7_file_account_year_perf": {
            "type": "table_file",
            "desc": "Write yearly perf results for all sectors to parquet file",
            "r": {
                "table": "account_period_sector_twr_cagr"
            },
            "w": {
                "top": {
                    "order": "account_id,period"
                },
                "having": "len(w.period) == 4 && w.sector == \"All\"",
                "url_template": "{dir_out}/account_year_perf.parquet",
                "columns": [
                    {
                        "parquet": {
                            "column_name": "ARK fund"
                        },
                        "name": "account_id",
                        "expression": "r.account_id",
                        "type": "string"
                    },
                    {
                        "parquet": {
                            "column_name": "Period"
                        },
                        "name": "period",
                        "expression": "r.period",
                        "type": "string"
                    },
                    {
                        "parquet": {
                            "column_name": "Sector"
                        },
                        "name": "sector",
                        "expression": "r.sector",
                        "type": "string"
                    },
                    {
                        "parquet": {
                            "column_name": "Time-weighted annualized return %"
                        },
                        "name": "cagr",
                        "expression": "math.Round(r.cagr*100)/100",
                        "type": "float"
                    }
                ]
            }
        }
    },
    "dependency_policies": {
        "current_active_first_stopped_nogo": {
            "is_default": true,
            "event_priority_order": "run_is_current(desc), node_start_ts(desc)",
            "rules": [
                {
                    "cmd": "go",
                    "expression": "e.run_is_current == true && e.run_final_status == wfmodel.RunStart && e.node_status == wfmodel.NodeBatchSuccess"
                },
                {
                    "cmd": "wait",
                    "expression": "e.run_is_current == true && e.run_final_status == wfmodel.RunStart && e.node_status == wfmodel.NodeBatchNone"
                },
                {
                    "cmd": "wait",
                    "expression": "e.run_is_current == true && e.run_final_status == wfmodel.RunStart && e.node_status == wfmodel.NodeBatchStart"
                },
                {
                    "cmd": "nogo",
                    "expression": "e.run_is_current == true && e.run_final_status == wfmodel.RunStart && e.node_status == wfmodel.NodeBatchFail"
                },
                {
                    "cmd": "go",
                    "expression": "e.run_is_current == false && e.run_final_status == wfmodel.RunStart && e.node_status == wfmodel.NodeBatchSuccess"
                },
                {
                    "cmd": "wait",
                    "expression": "e.run_is_current == false && e.run_final_status == wfmodel.RunStart && e.node_status == wfmodel.NodeBatchNone"
                },
                {
                    "cmd": "wait",
                    "expression": "e.run_is_current == false && e.run_final_status == wfmodel.RunStart && e.node_status == wfmodel.NodeBatchStart"
                },
                {
                    "cmd": "go",
                    "expression": "e.run_is_current == false && e.run_final_status == wfmodel.RunComplete && e.node_status == wfmodel.NodeBatchSuccess"
                },
                {
                    "cmd": "nogo",
                    "expression": "e.run_is_current == false && e.run_final_status == wfmodel.RunComplete && e.node_status == wfmodel.NodeBatchFail"
                }
            ]
        }
    }
}